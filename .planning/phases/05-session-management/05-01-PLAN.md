---
phase: 05-session-management
plan: 01
type: execute
---

<objective>
Implement full /progress command for rich project status display and intelligent routing.

Purpose: Replace placeholder with comprehensive progress tracking that shows recent work, current position, decisions, issues, and intelligently routes to the next action.
Output: Working /progress command that matches GSD framework functionality.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**Prior work:**
@src/chat/commands/index.ts - Current command registry with placeholder /progress
@src/chat/context/projectContext.ts - Existing context loading utilities

**GSD reference:**
@~/.claude/commands/gsd/progress.md - Full progress command specification

**Key patterns from Phase 4:**
- GlobalState for execution state persistence (04-02)
- Stream buttons for actions (02-02)
- File tree display with stream.filetree() (02-03)
- Plan parsing with regex (04-01)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create progress command handler</name>
  <files>src/chat/commands/progress.ts</files>
  <action>
Create new progress command handler that:

1. Verifies .planning/ structure exists (error with /new-project suggestion if not)
2. Loads full project context (STATE.md, ROADMAP.md, PROJECT.md)
3. Finds 2-3 most recent SUMMARY.md files to show recent work
4. Parses current position from STATE.md (phase, plan, status)
5. Calculates progress (total plans, completed, remaining)
6. Checks for blockers, concerns, deferred issues

Output rich status report with:
- Project name and visual progress bar
- Recent work section (from summaries)
- Current position with CONTEXT.md indicator
- Key decisions made
- Open issues
- What's next (from ROADMAP)

Pattern to follow from /status command: use stream.markdown() for text, stream.reference() for file links, stream.filetree() for folder structure.

DO NOT add emoji decorations. Keep output clean and professional.
  </action>
  <verify>TypeScript compiles without errors</verify>
  <done>Progress handler created with full status report rendering</done>
</task>

<task type="auto">
  <name>Task 2: Implement intelligent routing logic</name>
  <files>src/chat/commands/progress.ts</files>
  <action>
Add routing logic after status report to determine next action:

1. Count plans and summaries in current phase directory
2. Check for unaddressed UAT issues (*-ISSUES.md without *-FIX.md)
3. Check for unexecuted fix plans (*-FIX.md without *-FIX-SUMMARY.md)

Route based on conditions:
- If fixes without summary: Show "Execute fix plan" with path
- If issues without fix: Show "Plan fixes needed" suggestion
- If summaries < plans: Show "Execute next plan" with path
- If summaries = plans AND plans > 0: Check milestone status
- If plans = 0: Show "Plan this phase" suggestion

For each route, display:
- Clear action heading
- The exact command to run
- Recommendation to `/clear` first for fresh context
- Alternative actions as buttons

Use stream.button() for actionable commands. Buttons should use commands like 'hopper.chat-participant.plan-phase' pattern.
  </action>
  <verify>TypeScript compiles, routing logic handles all edge cases</verify>
  <done>Intelligent routing determines and displays correct next action</done>
</task>

<task type="auto">
  <name>Task 3: Register progress command and update help</name>
  <files>src/chat/commands/index.ts</files>
  <action>
1. Import handleProgress from './progress'
2. Replace placeholder registration with actual handler
3. Update COMMAND_DEFINITIONS to ensure progress description is accurate: "Check project progress and route to next action"

Also update the help command follow-ups to include progress as a contextual suggestion after new-project.

Remove progress from the placeholder handler creation loop (it's now fully implemented).
  </action>
  <verify>npm run compile succeeds, /progress no longer shows "Coming in Phase 3!"</verify>
  <done>Progress command registered and working</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run compile` succeeds without errors
- [ ] `/progress` shows rich status report in existing project
- [ ] `/progress` shows appropriate error in workspace without .planning/
- [ ] Routing logic correctly identifies next action
- [ ] Buttons trigger correct commands
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No TypeScript errors
- /progress matches GSD framework functionality
</success_criteria>

<output>
After completion, create `.planning/phases/05-session-management/05-01-SUMMARY.md`
</output>
