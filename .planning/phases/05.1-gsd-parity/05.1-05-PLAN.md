---
phase: 05.1-gsd-parity
plan: 05
type: execute
---

<objective>
Implement codebase mapping command and final parity verification.

Purpose: Enable codebase analysis that produces structured documentation, and verify 100% GSD feature parity.
Output: Working /map-codebase command and complete feature parity.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
checkpoint: required for final verification
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**GSD references:**
@~/.claude/commands/gsd/map-codebase.md
@~/.claude/get-shit-done/templates/codebase/architecture.md
@~/.claude/get-shit-done/templates/codebase/stack.md
@~/.claude/get-shit-done/templates/codebase/conventions.md
@~/.claude/get-shit-done/templates/codebase/structure.md
@~/.claude/get-shit-done/templates/codebase/concerns.md
@~/.claude/get-shit-done/templates/codebase/integrations.md
@~/.claude/get-shit-done/templates/codebase/testing.md

**Key patterns:**
- LLM for analysis (03-01, 03-03)
- Parallel execution concepts
- Comprehensive file scanning
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create map-codebase command</name>
  <files>src/chat/commands/mapCodebase.ts</files>
  <action>
Create /map-codebase command that:

1. Analyzes current workspace to understand:
   - File structure and organization
   - Technology stack (from package.json, etc.)
   - Architecture patterns
   - Coding conventions
   - Testing setup
   - External integrations
   - Known concerns/tech debt
2. For each analysis area, uses LLM to generate documentation:
   - ARCHITECTURE.md - System design, module structure
   - STACK.md - Technologies, versions, dependencies
   - CONVENTIONS.md - Coding patterns, naming, style
   - STRUCTURE.md - Directory organization, file purposes
   - CONCERNS.md - Tech debt, known issues
   - INTEGRATIONS.md - External services, APIs
   - TESTING.md - Test setup, coverage, patterns
3. Creates .planning/codebase/ directory with all documents
4. Commits: "docs(codebase): map codebase structure and patterns"

This enables /plan-phase to reference codebase context.
Stream progress as each document is generated.
  </action>
  <verify>TypeScript compiles without errors</verify>
  <done>Map-codebase generates comprehensive codebase documentation</done>
</task>

<task type="auto">
  <name>Task 2: Register command and update plan-phase integration</name>
  <files>src/chat/commands/index.ts, src/chat/commands/planPhase.ts</files>
  <action>
In index.ts:
1. Import handleMapCodebase from './mapCodebase'
2. Add to COMMAND_DEFINITIONS:
   - { name: 'map-codebase', description: 'Analyze codebase to produce planning documents' }
3. Register handler

In planPhase.ts:
1. Check if .planning/codebase/ exists
2. If exists, load relevant documents based on phase keywords:
   - UI phases: CONVENTIONS.md, STRUCTURE.md
   - API phases: ARCHITECTURE.md, CONVENTIONS.md
   - Database phases: ARCHITECTURE.md, STACK.md
   - Testing phases: TESTING.md, CONVENTIONS.md
3. Include loaded context in plan generation prompt

This makes plan-phase codebase-aware when mapping exists.
  </action>
  <verify>npm run compile succeeds, plan-phase uses codebase context</verify>
  <done>Codebase mapping integrated with planning workflow</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete GSD command parity in Hopper extension</what-built>
  <how-to-verify>
    Compare GSD commands vs Hopper commands:

    **GSD Framework Commands (23 total):**
    1. help - /help
    2. progress - /progress (05-01)
    3. new-project - /new-project
    4. create-roadmap - /create-roadmap
    5. plan-phase - /plan-phase
    6. execute-plan - /execute-plan
    7. pause-work - /pause-work (05-02)
    8. resume-work - /resume-work (05-02)
    9. consider-issues - /consider-issues (05-03)
    10. verify-work - /verify-work (05.1-03)
    11. plan-fix - /plan-fix (05.1-03)
    12. resume-task - /resume-task (05.1-03)
    13. research-phase - /research-phase (05.1-02)
    14. discuss-phase - /discuss-phase (05.1-02)
    15. list-phase-assumptions - /list-phase-assumptions (05.1-02)
    16. map-codebase - /map-codebase (05.1-05)
    17. add-phase - /add-phase (05.1-01)
    18. insert-phase - /insert-phase (05.1-01)
    19. remove-phase - /remove-phase (05.1-01)
    20. new-milestone - /new-milestone (05.1-04)
    21. complete-milestone - /complete-milestone (05.1-04)
    22. discuss-milestone - /discuss-milestone (05.1-04)

    **Verification:**
    1. Run: /help - verify all 22 commands listed
    2. Spot check 3-4 commands to ensure they work
    3. Compare feature depth to GSD framework

    **Additional Hopper-specific:**
    - /status (shows account/license status)
  </how-to-verify>
  <resume-signal>Type "approved" if all commands present and working, or describe any missing functionality</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run compile` succeeds without errors
- [ ] `/map-codebase` generates all 7 codebase documents
- [ ] `/plan-phase` loads codebase context when available
- [ ] All 22 GSD commands have Hopper equivalents
- [ ] /help lists all commands
- [ ] Human verification confirms parity
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Human verification approved
- 100% GSD command parity achieved
- Phase 5.1 complete
</success_criteria>

<output>
After completion, create `.planning/phases/05.1-gsd-parity/05.1-05-SUMMARY.md`

Document:
- Complete command mapping (GSD â†’ Hopper)
- Any intentional differences or enhancements
- Any gaps identified for future work

Update STATE.md and ROADMAP.md to mark Phase 5.1 complete.
</output>
