---
phase: 09-useability-and-skills
plan: 01
type: execute
---

<objective>
Add comprehensive output channel logging and visible error handling to Hopper execution.

Purpose: Make all operations observable — failures should be logged visibly, not silently swallowed. Users chose yolo mode for autonomous execution, but they still need to know when things go wrong.
Output: Dedicated Hopper output channel with structured logging for all operations.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./09-01-SUMMARY.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-useability-and-skills/09-CONTEXT.md

# Key files to modify:
@src/chat/commands/executePlan.ts
@src/extension.ts

# Prior context:
- Phase 8 fixed verify-work and discuss-phase UX
- Execution mode (yolo/guided/manual) already implemented in src/config/
- Tool invocations already logged to console.log but not visible to user
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create dedicated Hopper output channel with structured logging</name>
  <files>src/logging/outputChannel.ts, src/logging/index.ts, src/extension.ts</files>
  <action>
Create a new logging module with a singleton output channel:

1. Create src/logging/outputChannel.ts:
   - Export a singleton `HopperLogger` class
   - Methods: `info(message)`, `warn(message)`, `error(message)`, `success(message)`, `toolStart(toolName, input)`, `toolComplete(toolName, result)`, `toolError(toolName, error)`
   - Each log entry prefixed with timestamp: `[HH:MM:SS]`
   - Error logs should use `[ERROR]` prefix in red (via ANSI if supported, otherwise just text)
   - Auto-show output channel on errors (call `outputChannel.show(true)` to preserve focus)

2. Create src/logging/index.ts:
   - Export `getLogger()` function that returns the singleton
   - Initialize the output channel with name "Hopper"

3. Update src/extension.ts:
   - Import and initialize the logger on activation
   - Pass logger instance or make it globally accessible via singleton

Do NOT use console.log for user-visible output — that goes to developer console. The output channel is for user visibility.
  </action>
  <verify>
- Build succeeds: `npm run compile`
- Logger module exports correctly
- Output channel "Hopper" appears in VSCode Output panel dropdown
  </verify>
  <done>
- src/logging/outputChannel.ts exists with HopperLogger class
- src/logging/index.ts exports getLogger()
- Extension activates without errors
- "Hopper" output channel available in Output panel
  </done>
</task>

<task type="auto">
  <name>Task 2: Integrate logging into execute-plan command</name>
  <files>src/chat/commands/executePlan.ts</files>
  <action>
Update executePlan.ts to use the new logger:

1. Import the logger: `import { getLogger } from '../../logging';`

2. At start of handleExecutePlan:
   - `logger.info(`Starting execution: ${planPath}`)`

3. In executeWithTools function:
   - Replace console.log calls with logger equivalents
   - Before tool invocation: `logger.toolStart(part.name, toolInput)`
   - After successful tool: `logger.toolComplete(part.name, 'success')`
   - On tool error: `logger.toolError(part.name, errorMsg)` — this should auto-show the output channel

4. After each task completes:
   - Success: `logger.success(`Task ${task.id} completed: ${task.name}`)`
   - Failure: `logger.error(`Task ${task.id} failed: ${task.name} - ${errorMessage}`)`

5. On plan completion:
   - `logger.info(`Plan execution complete: ${successCount}/${totalTasks} tasks succeeded`)`

6. On any unhandled error in the command:
   - `logger.error(`Execution failed: ${error.message}`)`
   - Auto-show output channel so user sees the error

Keep the stream.markdown output as-is for the chat UI — the logger is for the Output channel (persistent, scrollable, copyable).
  </action>
  <verify>
- Build succeeds: `npm run compile`
- Run /execute-plan on a test plan
- Check Output > Hopper shows timestamped logs
- Errors auto-show the output channel
  </verify>
  <done>
- All console.log calls in executePlan.ts replaced with logger calls
- Tool invocations logged with toolStart/toolComplete/toolError
- Task completions logged with success/error
- Errors auto-show output channel
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run compile` succeeds without errors
- [ ] Extension activates and creates "Hopper" output channel
- [ ] Running /execute-plan produces visible logs in Output panel
- [ ] Errors automatically show the output channel
- [ ] No regressions in chat UI output (stream.markdown still works)
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No TypeScript errors
- Output channel logging works end-to-end
- Errors are visible (auto-show output channel)
</success_criteria>

<output>
After completion, create `.planning/phases/09-useability-and-skills/09-01-SUMMARY.md`
</output>
