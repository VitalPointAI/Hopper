---
phase: 01.5.3-rebrand-specflow-to-hopper
plan: 02
type: execute
---

<objective>
Update remaining source files and Worker to complete Hopper rebrand.

Purpose: Ensure all user-facing strings, storage keys, and API references use Hopper branding.
Output: Fully rebranded extension and Worker with consistent Hopper identity.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01.5.3-rebrand-specflow-to-hopper/01.5.3-01-SUMMARY.md

**Remaining rebrand scope:**
- src/licensing/*.ts - storage keys, config reads, display strings
- src/chat/commands/*.ts - command IDs, display strings
- src/chat/generators/*.ts - template comments
- src/provider/*.ts - error messages
- src/telemetry/*.ts - storage keys, config reads
- workers/ - package name, UI strings, auth messages (NOT contract IDs)

**Keep unchanged:**
- NEAR contract ID: license.specflow.near (deployed infrastructure)
- Admin wallet: specflow.near (real NEAR account)
- Worker URL default in code: Update to hopper-license-api.vitalpointai.workers.dev (will deploy later)
- Referral strings in NEAR Intents can stay as 'specflow' (internal tracking)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update licensing module references</name>
  <files>src/licensing/authManager.ts, src/licensing/walletAuth.ts, src/licensing/validator.ts, src/licensing/phaseGate.ts, src/licensing/upgradeModal.ts, src/licensing/nearRpc.ts, src/licensing/types.ts</files>
  <action>
Update all licensing files:

**authManager.ts:**
- SESSION_STORAGE_KEY: 'specflow.authSession' → 'hopper.authSession'
- CHALLENGE_STORAGE_KEY: 'specflow.pendingChallenge' → 'hopper.pendingChallenge'
- getConfiguration('specflow') → getConfiguration('hopper')
- URI callback: 'vscode://vitalpointai.specflow/auth-callback' → 'vscode://vitalpointai.hopper/auth-callback'
- Auth message: "authenticate with SpecFlow" → "authenticate with Hopper"

**walletAuth.ts:**
- SESSION_STORAGE_KEY: 'specflow.walletSession' → 'hopper.walletSession'
- CHALLENGE_STORAGE_KEY: 'specflow.pendingChallenge' → 'hopper.pendingChallenge'
- getConfiguration('specflow') → getConfiguration('hopper')
- URI callback: 'vscode://vitalpointai.specflow/auth-callback' → 'vscode://vitalpointai.hopper/auth-callback'
- Auth message: "authenticate with SpecFlow" → "authenticate with Hopper"

**validator.ts:**
- getConfiguration('specflow') → getConfiguration('hopper')
- Default URL: keep as-is for now (will be updated when Worker is redeployed)

**phaseGate.ts:**
- "SpecFlow Pro" → "Hopper Pro"
- URL: 'https://specflow.dev/pro' → 'https://hopper.dev/pro' (placeholder, will need actual domain)

**upgradeModal.ts:**
- viewType: 'specflowUpgrade' → 'hopperUpgrade'
- "Upgrade to SpecFlow Pro" → "Upgrade to Hopper Pro"
- "Full SpecFlow workflow" → "Full Hopper workflow"
- getConfiguration('specflow') → getConfiguration('hopper')
- Command: 'specflow.startOAuthForPayment' → 'hopper.startOAuthForPayment'
- URLs: specflow.dev/* → hopper.dev/* (Terms, Privacy)

**nearRpc.ts:**
- id: 'specflow' → 'hopper' (RPC request ID)

**types.ts:**
- contractId default: keep 'license.specflow.near' (infrastructure)
  </action>
  <verify>grep -l "specflow" src/licensing/*.ts shows only types.ts (for contract ID)</verify>
  <done>All licensing files use hopper.* keys and Hopper branding except infrastructure contract ID</done>
</task>

<task type="auto">
  <name>Task 2: Update chat commands and generators</name>
  <files>src/chat/commands/index.ts, src/chat/commands/types.ts, src/chat/commands/newProject.ts, src/chat/commands/createRoadmap.ts, src/chat/commands/planPhase.ts, src/chat/generators/planGenerator.ts, src/telemetry/telemetryService.ts, src/provider/nearAiProvider.ts</files>
  <action>
**src/chat/commands/index.ts:**
- Help description: "SpecFlow commands" → "Hopper commands"
- All command IDs: specflow.chat-participant.* → hopper.chat-participant.*
- specflow.showUpgradeModal → hopper.showUpgradeModal
- specflow.connect → hopper.connect
- "SpecFlow - No Project Found" → "Hopper - No Project Found"
- "SpecFlow project" → "Hopper project"
- "SpecFlow features" → "Hopper features"

**src/chat/commands/types.ts:**
- ISpecflowResult → IHopperResult (if not done in Plan 01)

**src/chat/commands/newProject.ts:**
- "initialized with SpecFlow" → "initialized with Hopper"
- specflow.chat-participant.* → hopper.chat-participant.*

**src/chat/commands/createRoadmap.ts:**
- specflow.chat-participant.* → hopper.chat-participant.*

**src/chat/commands/planPhase.ts:**
- "SpecFlow Pro" → "Hopper Pro"
- specflow.chat-participant.* → hopper.chat-participant.*
- specflow.connect → hopper.connect
- specflow.showUpgradeModal → hopper.showUpgradeModal

**src/chat/generators/planGenerator.ts:**
- "SpecFlow template" → "Hopper template" (if any comments)

**src/telemetry/telemetryService.ts:**
- INSTALL_ID_KEY: 'specflow.installId' → 'hopper.installId'
- Default API URL comment and value: specflow-license-api → hopper-license-api (for when Worker is redeployed)
- getConfiguration('specflow') → getConfiguration('hopper')
- Extension ID: 'vitalpoint.specflow' → 'vitalpoint.hopper'
- GlobalState keys: 'specflow.hasActivatedBefore' → 'hopper.hasActivatedBefore'

**src/provider/nearAiProvider.ts:**
- Error messages: "SpecFlow: Manage NEAR AI Connection" → "Hopper: Manage NEAR AI Connection"
- Command execution: 'specflow.manageNearAi' → 'hopper.manageNearAi'
  </action>
  <verify>grep -r "specflow" src/ --include="*.ts" | grep -v "specflow-license-api\|license.specflow.near" returns no matches</verify>
  <done>All src/ files use Hopper branding except infrastructure URLs/contract IDs</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete extension rebrand from SpecFlow to Hopper</what-built>
  <how-to-verify>
    1. Run: `npm run compile` (should succeed)
    2. Verify no "specflow" in user-facing code:
       ```
       grep -r "specflow" src/ --include="*.ts" | grep -v "specflow-license-api\|license.specflow.near"
       ```
       (should return nothing)
    3. Check package.json: `cat package.json | grep -E "name|displayName"`
       (should show "hopper" and "Hopper")
    4. Verify chat participant file renamed:
       `ls src/chat/hopperParticipant.ts`
       (should exist)
  </how-to-verify>
  <resume-signal>Type "approved" to continue with Worker rebrand, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run compile` succeeds
- [ ] No "specflow" in src/*.ts except infrastructure references
- [ ] All command IDs use hopper.* prefix
- [ ] All storage keys use hopper.* prefix
</verification>

<success_criteria>

- All tasks completed
- Extension fully rebranded to Hopper
- Compiles without errors
- Phase 01.5.3 complete
</success_criteria>

<output>
After completion, create `.planning/phases/01.5.3-rebrand-specflow-to-hopper/01.5.3-02-SUMMARY.md`:

# Phase 01.5.3 Plan 02: Complete Rebrand Summary

**[Substantive one-liner about what shipped]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified

- `path/to/file.ts` - Description

## Decisions Made

[Any decisions during execution]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Phase 01.5.3 complete. Note: Worker rebrand (wrangler.toml name change) will require redeployment and DNS update - tracked separately. Ready for Phase 2 or next roadmap item.
</output>
