---
phase: 01-foundation
plan: 01
type: execute
---

<objective>
Set up the VSCode extension project structure with TypeScript, esbuild bundling, and proper package.json configuration.

Purpose: Establish the foundation that all subsequent work depends on - a buildable, runnable extension shell.
Output: Working VSCode extension that activates and logs "SpecFlow extension activated" - ready for provider implementation.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation/01-RESEARCH.md

**From research - key requirements:**
- VSCode engine: ^1.104.0 (required for Language Model Chat Provider API)
- TypeScript with esbuild bundling
- Package.json contributions: languageModelChatProviders, commands
- Vendor ID: "near-ai"

**Tech stack:**
- typescript ^5.x
- @types/vscode ^1.104.0
- esbuild ^0.21.x
- eslint ^9.x (optional, can skip for MVP)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize extension project structure</name>
  <files>package.json, tsconfig.json, esbuild.js, .vscode/launch.json, .vscode/tasks.json, src/extension.ts</files>
  <action>
Create VSCode extension manually (faster than yo code for known structure):

1. **package.json** - Extension manifest with:
   - name: "specflow"
   - displayName: "SpecFlow"
   - publisher: "vitalpointai"
   - engines.vscode: "^1.104.0"
   - main: "./dist/extension.js"
   - activationEvents: [] (empty for on-demand)
   - contributes.languageModelChatProviders: [{ vendor: "near-ai", displayName: "NEAR AI", managementCommand: "specflow.manageNearAi" }]
   - contributes.commands: [{ command: "specflow.manageNearAi", title: "Manage NEAR AI Connection", category: "SpecFlow" }]
   - scripts: compile, watch, package
   - devDependencies: typescript, @types/vscode, esbuild

2. **tsconfig.json** - TypeScript config:
   - target: ES2022
   - module: Node16
   - moduleResolution: Node16
   - strict: true
   - outDir: ./dist
   - rootDir: ./src

3. **esbuild.js** - Build script:
   - Entry: src/extension.ts
   - Output: dist/extension.js
   - External: vscode
   - Format: cjs
   - Platform: node
   - Bundle: true
   - Sourcemap: true

4. **.vscode/launch.json** - Debug config for Extension Development Host

5. **.vscode/tasks.json** - Build task for watch mode

6. **src/extension.ts** - Minimal activation:
   - Export activate(context) that logs activation
   - Export deactivate() stub
   - NO provider registration yet (Plan 01-03)

**Avoid:**
- Don't use yo code - it adds unnecessary boilerplate and prompts
- Don't add eslint yet - can add later if needed
- Don't add test infrastructure yet - Phase 2+
  </action>
  <verify>
ls -la package.json tsconfig.json esbuild.js src/extension.ts .vscode/
npm install
npm run compile
  </verify>
  <done>
- All files created
- npm install succeeds without errors
- npm run compile produces dist/extension.js
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify extension loads in development host</name>
  <files>dist/extension.js</files>
  <action>
1. Build the extension: `npm run compile`

2. Verify output exists and is valid:
   - dist/extension.js should be a CJS bundle
   - No external dependencies bundled (vscode is external)

3. Create a simple test to verify the bundle:
   - Check dist/extension.js contains "SpecFlow extension activated"
   - Check bundle size is reasonable (<50KB for shell)

4. Document how to test in Extension Development Host:
   - Press F5 in VSCode to launch debug session
   - Check Output > "SpecFlow" channel for activation log

**Note:** Manual verification of Extension Development Host will happen in Plan 01-03 checkpoint. This task ensures the build output is correct.
  </action>
  <verify>
npm run compile && ls -la dist/extension.js && grep -l "activated" dist/extension.js
  </verify>
  <done>
- dist/extension.js exists
- File contains activation log string
- Build completes without TypeScript errors
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm install` completes without errors
- [ ] `npm run compile` produces dist/extension.js
- [ ] No TypeScript errors
- [ ] package.json has correct engine version (^1.104.0)
- [ ] package.json has languageModelChatProviders contribution
</verification>

<success_criteria>

- All files created per specification
- Build succeeds
- Extension structure matches research recommendations
- Ready for NEAR AI client implementation (Plan 01-02)
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
