---
phase: 01.5-licensing
plan: 03-FIX
type: fix
---

<objective>
Fix 1 UAT issue from plan 01.5-03.

Source: 01.5-03-ISSUES.md
Priority: 1 blocker, 0 major, 0 minor
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-phase.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md

**Issues being fixed:**
@.planning/phases/01.5-licensing/01.5-03-ISSUES.md

**Original plan for reference:**
@.planning/phases/01.5-licensing/01.5-03-PLAN.md

**File to fix:**
@workers/license-api/src/services/near-intents.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix UAT-001 - Change depositType for ANY_INPUT swap</name>
  <files>workers/license-api/src/services/near-intents.ts</files>
  <action>
The NEAR Intents 1Click API requires `depositType: INTENTS` when using `swapType: ANY_INPUT`.

In `workers/license-api/src/services/near-intents.ts`, find the `createSubscriptionIntent` function and change line 70 from:
```typescript
depositType: QuoteRequest.depositType.ORIGIN_CHAIN
```
to:
```typescript
depositType: QuoteRequest.depositType.INTENTS
```

This is a one-line fix. The error message from the API was explicit:
"ANY_INPUT only supports depositType INTENTS"
  </action>
  <verify>
1. Run `npm run typecheck` - should pass
2. Start worker with `npm run dev`
3. Call endpoint: `curl -X POST http://localhost:8787/api/crypto/subscribe -H "Content-Type: application/json" -d '{"nearAccountId":"test.near"}'`
4. Should return 201 with JSON containing intentId and depositAddress (not 500 error)
  </verify>
  <done>Subscribe endpoint returns 201 with deposit address instead of 500 error</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] TypeScript compiles without errors
- [ ] Subscribe endpoint returns 201 with deposit address
- [ ] No other regressions introduced
</verification>

<success_criteria>
- UAT-001 fixed: depositType changed from ORIGIN_CHAIN to INTENTS
- Subscribe endpoint works as expected
- Ready for re-verification
</success_criteria>

<output>
After completion, create `.planning/phases/01.5-licensing/01.5-03-FIX-SUMMARY.md`

Also update `.planning/phases/01.5-licensing/01.5-03-ISSUES.md`:
- Move UAT-001 to "Resolved Issues" section
- Add resolution date and commit hash
</output>
