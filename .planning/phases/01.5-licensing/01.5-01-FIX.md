---
phase: 01.5-licensing
plan: 01-FIX
type: fix
---

<objective>
Fix 1 UAT issue from plan 01.5-01.

Source: 01.5-01-ISSUES.md
Priority: 0 critical, 1 major, 0 minor
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-phase.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md

**Issues being fixed:**
@.planning/phases/01.5-licensing/01.5-01-ISSUES.md

**Original plan for reference:**
@.planning/phases/01.5-licensing/01.5-01-PLAN.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix cargo near build validation errors</name>
  <files>contracts/license/.cargo/config.toml, contracts/license/Cargo.toml</files>
  <action>
Fix the bulk memory validation error for cargo-near build:

1. Create `contracts/license/.cargo/config.toml` with proper rustflags for NEAR contract compilation:
   ```toml
   [target.wasm32-unknown-unknown]
   rustflags = ["-C", "link-arg=-s"]
   ```

2. If that doesn't work, the issue is likely that cargo-near uses wasm-opt which doesn't support bulk memory by default. Check if there's a cargo-near configuration or if we need to add build configuration.

3. Alternative approach: Add `[package.metadata.near.build]` section to Cargo.toml to configure cargo-near build flags.

4. Research the current cargo-near best practices for near-sdk 5.x compatibility.

The goal is to have `cargo near build` produce a valid WASM artifact that passes validation.
  </action>
  <verify>cargo near build --manifest-path contracts/license/Cargo.toml succeeds without validation errors</verify>
  <done>cargo near build produces deployable WASM artifact, passes wasm-validator</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cargo near build` succeeds in contracts/license directory
- [ ] No wasm-validator errors about bulk memory
- [ ] WASM artifact exists and is non-empty
- [ ] `cargo test` still passes
</verification>

<success_criteria>
- UAT-001 resolved: cargo near build works
- Tests still pass
- Ready for re-verification
</success_criteria>

<output>
After completion, create `.planning/phases/01.5-licensing/01.5-01-FIX-SUMMARY.md`
</output>
