---
phase: 07-planning-depth
plan: 02
type: feature
subsystem: config
requires:
  - phase: 07-01
    provides: HopperConfig types and ConfigManager
provides:
  - Interactive depth picker UI
  - Interactive mode picker UI
  - Integration with /new-project command
affects: [newProject]
---

# Plan 07-02: Interactive Selection UI

## Objective

<objective>
Add interactive QuickPick dialogs to let users choose planning depth and execution mode during /new-project. Store selections in .planning/config.json for the project.
</objective>

## Tasks

<tasks>
<task type="auto" id="1">
  <name>Create depth selection helper</name>
  <files>src/config/selectionUI.ts</files>
  <action>
Create src/config/selectionUI.ts with:

selectPlanningDepth(): Promise<PlanningDepth | undefined>
- Use vscode.window.showQuickPick with items:
  - Quick: "Minimal detail, fast generation. Good for simple projects or prototypes."
  - Standard (Recommended): "Balanced detail for most projects. Clear phases and tasks."
  - Comprehensive: "Maximum detail with thorough analysis. Best for complex projects."
- Set 'Standard' as the default selected item
- Return the selected depth or undefined if cancelled

selectExecutionMode(): Promise<ExecutionMode | undefined>
- Use vscode.window.showQuickPick with items:
  - Yolo: "No confirmations. Auto-execute all tasks without pausing."
  - Guided (Recommended): "Pause at checkpoints for review. Resume with approval."
  - Manual: "Confirm every task before execution. Maximum control."
- Set 'Guided' as the default selected item
- Return the selected mode or undefined if cancelled

showConfigurationSummary(config: HopperConfig, stream: vscode.ChatResponseStream): void
- Display the current configuration in chat stream
- Format as markdown table showing depth and mode with descriptions
  </action>
  <verify>Selection functions show QuickPick with correct options</verify>
  <done>Functions return correct type or undefined on cancel</done>
</task>

<task type="auto" id="2">
  <name>Update config module exports</name>
  <files>src/config/index.ts</files>
  <action>
Update src/config/index.ts to re-export:
- selectPlanningDepth from './selectionUI'
- selectExecutionMode from './selectionUI'
- showConfigurationSummary from './selectionUI'
  </action>
  <verify>All selection functions are exported from config module</verify>
  <done>Import { selectPlanningDepth, selectExecutionMode } from './config' works</done>
</task>

<task type="auto" id="3">
  <name>Integrate selection into /new-project</name>
  <files>src/chat/commands/newProject.ts</files>
  <action>
Modify handleNewProject to add configuration selection after PROJECT.md is created:

1. Import ConfigManager and selection functions from '../../config'
2. After successful PROJECT.md creation (after saveProject succeeds):
   a. Show progress: "Configuring project settings..."
   b. Call selectPlanningDepth() - if cancelled, use 'standard'
   c. Call selectExecutionMode() - if cancelled, use 'guided'
   d. Create ConfigManager with workspaceUri
   e. Save config with selected depth and mode
   f. Show configuration summary using showConfigurationSummary

3. Add configuration summary after "### Project Details" section:
   - Show selected depth with description
   - Show selected mode with description
   - Add note: "Change settings anytime with `/configure`"

Keep the flow non-blocking: if user cancels either picker, use defaults and continue.
  </action>
  <verify>Running /new-project prompts for depth and mode after project creation</verify>
  <done>Config saved to .planning/config.json with user selections</done>
</task>

<task type="checkpoint:human-verify" id="4">
  <what-built>Interactive configuration selection in /new-project</what-built>
  <how-to-verify>
    1. Run /new-project with a test project description
    2. Verify QuickPick appears for planning depth selection
    3. Verify QuickPick appears for execution mode selection
    4. Check .planning/config.json is created with selections
    5. Verify cancelling a picker uses default values
  </how-to-verify>
  <resume-signal>Mark approved to continue</resume-signal>
</task>
</tasks>

## Verification

<verification>
- [ ] npm run compile succeeds
- [ ] selectPlanningDepth shows 3 options with descriptions
- [ ] selectExecutionMode shows 3 options with descriptions
- [ ] /new-project prompts for configuration after PROJECT.md creation
- [ ] .planning/config.json is created with user selections
- [ ] Cancelling selection uses default values without error
</verification>

## Success Criteria

<success-criteria>
- Users can select planning depth during project setup
- Users can select execution mode during project setup
- Selections persist in .planning/config.json
- Default values used gracefully when cancelled
- Configuration summary displayed after selection
</success-criteria>
