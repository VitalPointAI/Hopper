---
phase: 03-planning-commands
plan: 02-FIX
type: fix
---

<objective>
Fix non-functional stream.button() calls across the extension.

**Problem:** Buttons rendered via stream.button() don't respond to clicks. The buttons reference commands like `specflow.chat-participant.new-project`, `specflow.chat-participant.status`, etc., but these commands aren't properly registered.

**Root cause:** stream.button() requires the command to be registered via vscode.commands.registerCommand(). Currently only a placeholder exists for new-project, and it shows a message instead of invoking the chat participant command.

**Solution:** Register VSCode commands that invoke the chat participant with the appropriate slash command, or use a different button approach.
</objective>

<context>
@.planning/phases/03-planning-commands/03-02-ISSUES.md
@src/extension.ts
@src/chat/commands/index.ts
@src/chat/commands/createRoadmap.ts
@src/chat/commands/newProject.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Register chat participant command wrappers</name>
  <files>src/extension.ts</files>
  <action>
Register VSCode commands that trigger chat participant slash commands.

The challenge: stream.button() can only trigger registered VSCode commands. We need commands that will invoke the @specflow chat participant with the right slash command.

**Option A - Use vscode.commands.executeCommand to open chat:**
```typescript
vscode.commands.registerCommand('specflow.chat-participant.new-project', async () => {
  // Open the chat and send the command
  await vscode.commands.executeCommand('workbench.action.chat.open');
  await vscode.commands.executeCommand('workbench.action.chat.sendToNewChat', {
    text: '@specflow /new-project'
  });
});
```

**Option B - Show info message with guidance:**
```typescript
vscode.commands.registerCommand('specflow.chat-participant.new-project', () => {
  vscode.window.showInformationMessage(
    'Use @specflow /new-project in the chat panel to create a new project.'
  );
});
```

Try Option A first - it provides better UX. Register commands for:
- specflow.chat-participant.new-project
- specflow.chat-participant.create-roadmap
- specflow.chat-participant.plan-phase
- specflow.chat-participant.status
- specflow.chat-participant.progress
- specflow.chat-participant.help

Replace the existing placeholder registration.
  </action>
  <verify>npm run compile succeeds</verify>
  <done>
- All button commands registered in extension.ts
- Commands invoke chat participant with correct slash command
  </done>
</task>

<task type="auto">
  <name>Task 2: Test button functionality</name>
  <files>src/extension.ts</files>
  <action>
If the chat.sendToNewChat approach doesn't work (VSCode may not expose this), try alternatives:

1. Check VSCode Chat API for programmatic message sending
2. If not available, fall back to opening chat with helpful message
3. Document the working approach

The goal is: clicking a button should result in the command being executed, not just showing a message.
  </action>
  <verify>
- Launch extension in dev host
- Click a button (e.g., "Create Project" from /help when no project exists)
- Verify the corresponding slash command is executed
  </verify>
  <done>
- Buttons trigger their corresponding slash commands
- OR buttons provide clear guidance to use slash commands
  </done>
</task>

</tasks>

<verification>
- [ ] npm run compile succeeds
- [ ] Click "Create Project" button from /help → /new-project command runs
- [ ] Click "View ROADMAP.md" button → file opens
- [ ] Click "View Status" button → /status command runs
- [ ] No console errors when clicking buttons
</verification>

<success_criteria>
- All stream.button() calls now functional
- Users can click buttons to execute commands
- No placeholder messages for implemented commands
</success_criteria>

<output>
After completion, update 03-02-ISSUES.md to mark UAT-001 as resolved.
</output>
